


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper/devguide/app/css/styles.min.css">

    <!-- non-retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-72x72.png" sizes="72x72">

    <!-- retina iPhone pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-114x114.png" sizes="114x114">

    <!-- retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/resharper/devguide/apple-touch-icon-precomposed.png">

    <!-- normal favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/resharper/devguide/favicon.ico">
    <link rel="icon" type="image/png" href="/resharper/devguide/favicon.png">
<link  rel="stylesheet" href="/resharper/devguide/styles/styles.css"></head>
<body data-id="Extensions/Packaging">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="https://youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="packaging-and-distribution" class="elem-anchor"></a>
<h1>Packaging and Distribution<a href="#packaging-and-distribution" class="anchor-link"><span></span></a></h1>

<p>Packaging for the ReSharper Platform is very similar to the way extensions were packaged for <a href="Packaging8.html"><span>ReSharper 8</span></a> - it is recommended you familiarise yourself with that guide before continuing. An extension is distributed as a NuGet package, and hosted on a <a href="https://resharper-plugins.jetbrains.com" data-bypass="yes"><span>NuGet gallery</span></a>. However, because ReSharper extensions are runtime code, rather than compile time dependencies, the use case for ReSharper extension packages is very different to standard NuGet packages. Because of this, they have a different file layout internally.</p>

<p>Instead of adding assembly references to the <code class="code highlight language-text">lib</code> folder, ReSharper extensions should add all binaries to the <code class="code highlight language-text">DotFiles</code> root folder inside the package. This is different to ReSharper 8, where the top level folder was <code class="code highlight language-text">ReSharper</code>. This is because extensions are now extensions to the ReSharper Platform, rather than just to ReSharper. The top level folder name has changed to reflect this.</p>

<p>Also unlike ReSharper 8 packages, ReSharper Platform extension packages do not provide a folder for previous versions (e.g. <code class="code highlight language-text">ReSharper\v8.1</code>, <code class="code highlight language-text">ReSharper\v8.2</code>, etc.). ReSharper 8.x packages tended to be updated in a timely manner for new versions of ReSharper, and maintaining previous versions in a package became unnecessary and a maintenance overhead for plugin authors, if they chose to do it at all. This means binaries should be copied to the <code class="code highlight language-text">DotFiles</code> folder directly.</p>

<aside class="note">
  <p> When installing, all binary files in the package are copied to the main ReSharper Platform installation folder. This means that duplicate names should be avoided at all costs! The installer will refuse to install a package that introduces a duplicate file name.</p>

  <p>It is recommended that plugin assembly names use a prefix to ensure their assemblies are unique, e.g. CitizenMatt.Xunit.dll.</p>
</aside>

<p>This has an impact on dependencies - any dependent assemblies included in the extension package will be copied to the main installation directory, too, so it is easy to see how clashes can occur. Dependencies should either be ILMerge’d into the main extension, or ideally, added as NuGet package dependencies. However, the installer cannot handle dependencies which have more than one copy of the same assembly - for example, if adding <code class="code highlight language-text">xunit.dll</code> using the <code class="code highlight language-text">xunit</code> NuGet package, the installer does not know which copy to take, the one in <code class="code highlight language-text">lib\net45</code>, <code class="code highlight language-text">lib\portable</code>, etc. JetBrains currently uses private dependency packages that only contain a single copy of the assembly to work around this limitation.</p>

<p>The package must also add a dependency to the package called “Wave”. This is the package that represents the core version of the ReSharper Platform. For ReSharper 9.0, this is Wave 1.0, so the dependency should be added as <code class="code highlight language-text">Wave [1.0]</code>. ReSharper 9.1 is <code class="code highlight language-text">Wave [2.0]</code>. Without this dependency, when the package will not be added to the correct feed on the extensions gallery, and won’t be visible in the Extension Manager.</p>

<aside class="note">
  <p> Package dependencies are case sensitive, and the installer will (silently!) refuse to install a package that does not have the correct dependency on “Wave”.</p>
</aside>

<aside class="note">
  <p> The extension package needs to have a name that includes a “.” separator, or the installer will refuse to install it. This is used by the installer to produce “Company name” metadata. The package should be in the format “Company.Package”, e.g. “JetBrains.Plugins” or “CitizenMatt.Xunit”.</p>
</aside>

<aside class="note">
  <p> The package should not have a dependency on other NuGet packages, such as <code class="code highlight language-text">JetBrains.ReSharper.SDK</code>. The extension NuGet package is intended to be consumed by ReSharper at runtime, rather than being referenced by a project at compile time.</p>
</aside>

<p>Extensions can include settings and annotations files, by including the files in a folder in the format <code class="code highlight language-text">DotFiles\Extensions\{packageId}\annotations\</code> or <code class="code highlight language-text">DotFiles\Extensions\{packageId}\settings\</code>, where <code class="code highlight language-text">{packageId}</code> is the full ID of the package, e.g. <code class="code highlight language-text">DotFiles\Extensions\CitizenMatt.Xunit\annotations\xunit.xml</code> or <code class="code highlight language-text">DotFiles\Extensions\CitizenMatt.Xunit\settings\template.dotSettings</code>. These files are copied directly, with the same folder structure into the main installation directory. This folder structure is intended to prevent name clashes. If the folder name under <code class="code highlight language-text">DotFiles\Extensions</code> does not match the package ID directly (case insensitive), then the files will not be loaded.</p>



                    <div class="last-modified">
                        Last modified: 22 June 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper/devguide/app/js/main.build" data-baseurl="/resharper/devguide/" src="/resharper/devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

