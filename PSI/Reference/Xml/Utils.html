


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper/devguide/app/css/styles.min.css">

    <!-- non-retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-72x72.png" sizes="72x72">

    <!-- retina iPhone pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-114x114.png" sizes="114x114">

    <!-- retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/resharper/devguide/apple-touch-icon-precomposed.png">

    <!-- normal favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/resharper/devguide/favicon.ico">
    <link rel="icon" type="image/png" href="/resharper/devguide/favicon.png">
<link  rel="stylesheet" href="/resharper/devguide/styles/styles.css"></head>
<body data-id="PSI/Reference/Xml/Utils">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="https://youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="utils" class="elem-anchor"></a>
<h1>Utils<a href="#utils" class="anchor-link"><span></span></a></h1>

<!-- Index A - Z (auto-generated. Remove this line if manually adding/removing entries) -->

<ul id="markdown-toc">
  <li><a href="#m" id="markdown-toc-m"><span>M<a href="#m" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#modulequalificationutil" id="markdown-toc-modulequalificationutil"><span>ModuleQualificationUtil<a href="#modulequalificationutil" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#r" id="markdown-toc-r"><span>R<a href="#r" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#referencewithtokenutil" id="markdown-toc-referencewithtokenutil"><span>ReferenceWithTokenUtil<a href="#referencewithtokenutil" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
  <li><a href="#x" id="markdown-toc-x"><span>X<a href="#x" class="anchor-link"><span></span></a></span></a>    <ul>
      <li><a href="#xmlattributecontainerextensions" id="markdown-toc-xmlattributecontainerextensions"><span>XmlAttributeContainerExtensions<a href="#xmlattributecontainerextensions" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlattributeextension" id="markdown-toc-xmlattributeextension"><span>XmlAttributeExtension<a href="#xmlattributeextension" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlattributeextensions" id="markdown-toc-xmlattributeextensions"><span>XmlAttributeExtensions<a href="#xmlattributeextensions" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlattributeutil" id="markdown-toc-xmlattributeutil"><span>XmlAttributeUtil<a href="#xmlattributeutil" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlelementfactoryextensions" id="markdown-toc-xmlelementfactoryextensions"><span>XmlElementFactoryExtensions<a href="#xmlelementfactoryextensions" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmlreferenceutil" id="markdown-toc-xmlreferenceutil"><span>XmlReferenceUtil<a href="#xmlreferenceutil" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmltagextensions" id="markdown-toc-xmltagextensions"><span>XmlTagExtensions<a href="#xmltagextensions" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xmltagutil" id="markdown-toc-xmltagutil"><span>XmlTagUtil<a href="#xmltagutil" class="anchor-link"><span></span></a></span></a></li>
      <li><a href="#xpathutil" id="markdown-toc-xpathutil"><span>XPathUtil<a href="#xpathutil" class="anchor-link"><span></span></a></span></a></li>
    </ul>
  </li>
</ul>

<a name="m" class="elem-anchor"></a>
<h2>M<a href="#m" class="anchor-link"><span></span></a></h2>

<a name="modulequalificationutil" class="elem-anchor"></a>
<h3>ModuleQualificationUtil<a href="#modulequalificationutil" class="anchor-link"><span></span></a></h3>

<!-- Begin ModuleQualificationUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ModuleQualificationUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetModuleName</span><span class="p">(</span><span class="n">IPsiModule</span> <span class="n">psiModule</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetModuleQualification</span><span class="p">(</span><span class="n">IPsiModule</span> <span class="n">module</span><span class="p">,</span> <span class="n">IModuleReferenceResolveContext</span> <span class="n">context</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTypeName</span><span class="p">(</span><span class="n">IXmlAttributeValue</span> <span class="k">value</span><span class="p">,</span> <span class="k">out</span> <span class="n">AssemblyNameInfo</span> <span class="n">assemblyName</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TreeTextRange</span> <span class="nf">GetTypeNameCompletionRange</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">,</span> <span class="n">TreeOffset</span> <span class="n">offset</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TextRange</span> <span class="nf">GetTypeNameFullRange</span><span class="p">(</span><span class="kt">string</span> <span class="n">text</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsIdentifierChar</span><span class="p">(</span><span class="n">Char</span> <span class="n">c</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsTypeNameChar</span><span class="p">(</span><span class="n">Char</span> <span class="n">c</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="n">ITypeElement</span><span class="p">&gt;</span> <span class="n">ResolveType</span><span class="p">(</span><span class="kt">string</span> <span class="n">clrName</span><span class="p">,</span> <span class="n">IPsiModule</span> <span class="n">module</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">caseSensitive</span><span class="p">,</span> <span class="n">IModuleReferenceResolveContext</span> <span class="n">context</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattributevalue"><span>IXmlAttributeValue</span></a></li>
</ul>

<!-- End ModuleQualificationUtil -->

<p>Helper methods to support references to CLR types inside XML documents, e.g. web.config files.</p>

<ul>
  <li><code class="code highlight language-text">GetModuleName</code> returns the name of the given module, e.g. if it’s a project, then return the assembly name, else return the module’s name.</li>
  <li><code class="code highlight language-text">GetModuleQualification</code> returns the fully qualified assembly name of the module, either the compiled assemblies name, or the name built up from the project settings.</li>
  <li><code class="code highlight language-text">GetTypeName</code> returns a CLR type name and assembly name info from an assembly qualified type name specified in an XML attribute. Defers to <code class="code highlight language-text">JetBrains.Metadata.Utils.ModuleQualificationUtil.GetTypeName</code>.</li>
  <li><code class="code highlight language-text">GetTypeNameCompletionRange</code> takes in a string and a starting offset and works out from the text where a type name will start and end, by walking backwards from the start while <code class="code highlight language-text">IsTypeNameChar</code> is true, and walking forwards while <code class="code highlight language-text">IsIdentifierChar</code> is true.</li>
  <li><code class="code highlight language-text">GetTypeNameFullRange</code> returns the full range of a type name inside a given string. This is different to <code class="code highlight language-text">GetTypeNameCompletionRange</code> by allowing type name characters after the start offset, which allows for the current offset to be in a namespace, or for the type name to include nested types.</li>
  <li><code class="code highlight language-text">IsIdentifierChar</code> returns <code class="code highlight language-text">true</code> if the given character is a letter, digit or the underscore symbol (<code class="code highlight language-text">_</code>).</li>
  <li><code class="code highlight language-text">IsTypeNameChar</code> returns <code class="code highlight language-text">true</code> if the given character is a letter, digit, or either an underscore, period, plus or backtick symbol (<code class="code highlight language-text">_</code>, <code class="code highlight language-text">.</code>, <code class="code highlight language-text">+</code> or <code class="code highlight language-text">\</code>`).</li>
  <li><code class="code highlight language-text">ResolveType</code> retrieves a collection of <code class="code highlight language-text">ITypeElement</code> instances for the given CLR name, using an <code class="code highlight language-text">ISymbolScope</code> retrieved via <code class="code highlight language-text">IPsiServices.Symbols</code>.</li>
</ul>

<a name="r" class="elem-anchor"></a>
<h2>R<a href="#r" class="anchor-link"><span></span></a></h2>

<a name="referencewithtokenutil" class="elem-anchor"></a>
<h3>ReferenceWithTokenUtil<a href="#referencewithtokenutil" class="anchor-link"><span></span></a></h3>

<!-- Begin ReferenceWithTokenUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ReferenceWithTokenUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">AddRestoreTransactionAction</span><span class="p">(</span><span class="n">IPsiServices</span> <span class="n">psiServices</span><span class="p">,</span> <span class="n">IReferenceWithToken</span> <span class="n">referenceWithToken</span><span class="p">,</span> <span class="n">ElementRange</span><span class="p">&lt;</span><span class="n">IXmlToken</span><span class="p">&gt;</span> <span class="n">oldRange</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlToken</span> <span class="nf">SetText</span><span class="p">(</span><span class="n">IXmlToken</span> <span class="n">token</span><span class="p">,</span> <span class="n">TreeTextRange</span> <span class="n">oldRange</span><span class="p">,</span> <span class="kt">string</span> <span class="n">newText</span><span class="p">,</span> <span class="n">ITreeNode</span> <span class="n">elementToDropReferences</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IReferenceWithToken</span> <span class="nf">SetText</span><span class="p">(</span><span class="n">IReferenceWithToken</span> <span class="n">reference</span><span class="p">,</span> <span class="kt">string</span> <span class="n">newText</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmltoken"><span>IXmlToken</span></a></li>
</ul>

<!-- End ReferenceWithTokenUtil -->

<p>Helper methods for handling references within a token node. The methods defer to <code class="code highlight language-text">ReferenceWithinElementUtil&lt;IXmlToken&gt;</code>. The <code class="code highlight language-text">SetText</code> methods provide a factory method to create an appropriate token to replace the existing element.</p>

<a name="x" class="elem-anchor"></a>
<h2>X<a href="#x" class="anchor-link"><span></span></a></h2>

<a name="xmlattributecontainerextensions" class="elem-anchor"></a>
<h3>XmlAttributeContainerExtensions<a href="#xmlattributecontainerextensions" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlAttributeContainerExtensions -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlAttributeContainerExtensions</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TAttribute</span> <span class="n">GetAttribute</span><span class="p">&lt;</span><span class="n">TAttribute</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IXmlAttributeContainer</span> <span class="n">container</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlAttribute</span> <span class="nf">GetAttribute</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlAttributeContainer</span> <span class="n">container</span><span class="p">,</span> <span class="k">this</span> <span class="n">Predicate</span><span class="p">&lt;</span><span class="n">IXmlAttribute</span><span class="p">&gt;</span> <span class="n">predicate</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlAttribute</span> <span class="nf">GetAttribute</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlAttributeContainer</span> <span class="n">container</span><span class="p">,</span> <span class="k">this</span> <span class="kt">string</span> <span class="n">fullName</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlattributecontainer"><span>IXmlAttributeContainer</span></a></li>
</ul>

<!-- End XmlAttributeContainerExtensions -->

<p>Gets an attribute from an instance of <a href="TreeNodes.html#ixmlattributecontainer"><span><code class="code highlight language-text">IXmlAttributeContainer</code></span></a> either of a specific derived type, or matching a predicate, or based on name (including namespace prefix, if specified).</p>

<a name="xmlattributeextension" class="elem-anchor"></a>
<h3>XmlAttributeExtension<a href="#xmlattributeextension" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlAttributeExtension -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlAttributeExtension</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetUnquotedText</span><span class="p">(</span><span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">,</span> <span class="k">out</span> <span class="n">TreeTextRange</span> <span class="n">range</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">DocumentRange</span> <span class="nf">GetUnquotedValueRange</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a></li>
</ul>

<!-- End XmlAttributeExtension -->

<p>Helper methods to get information about the unquoted text of an instance of <a href="TreeNodes.html#ixmlattribute"><span><code class="code highlight language-text">IXmlAttribute</code></span></a>. <code class="code highlight language-text">GetUnquotedText</code> will return the unquoted text, as well as the tree range of the value. It is better to use the properties on <a href="TreeNodes.html#ixmlvaluetoken"><span><code class="code highlight language-text">IXmlValueToken</code></span></a>, as that implementation will cache the values for repeated calls. <code class="code highlight language-text">GetUnquotedValueRange</code> returns the range of the unquoted value, relative to the document the XML PSI is hosted inside (this might be an XML file, or an XML island inside another doucment).</p>

<a name="xmlattributeextensions" class="elem-anchor"></a>
<h3>XmlAttributeExtensions<a href="#xmlattributeextensions" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlAttributeExtensions -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlAttributeExtensions</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlAttribute</span> <span class="n">xmlAttribute</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a></li>
</ul>

<!-- End XmlAttributeExtensions -->

<p>Convenience method. Will remove the given attribute from it’s parent tag via <code class="code highlight language-text">IXmlTag.RemoveAttribute()</code>, or directly removes it from the tree if it’s not a child of a tag.</p>

<a name="xmlattributeutil" class="elem-anchor"></a>
<h3>XmlAttributeUtil<a href="#xmlattributeutil" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlAttributeUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlAttributeUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SetValue</span><span class="p">(</span><span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">,</span> <span class="kt">string</span> <span class="n">unquotedValue</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="n">DocumentRange</span> <span class="nf">UnquotedValueDocumentRange</span><span class="p">(</span><span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TreeTextRange</span> <span class="nf">UnquotedValueRange</span><span class="p">(</span><span class="n">IXmlAttribute</span> <span class="n">attribute</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a></li>
</ul>

<!-- End XmlAttributeUtil -->

<p>Helper methods for working with XML attributes. <code class="code highlight language-text">SetValue</code> replaces an attributes value by creating a new instance of <code class="code highlight language-text">IXmlAttributeValue</code> and modifying the tree (it takes the write lock, so the caller doesn’t have to). The other methods return the range of the unquoted value of the attribute, relative to the tree, and relative to the document. These may be different if the XML <code class="code highlight language-text">IFile</code> is not the primary PSI tree in the file.</p>

<a name="xmlelementfactoryextensions" class="elem-anchor"></a>
<h3>XmlElementFactoryExtensions<a href="#xmlelementfactoryextensions" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlElementFactoryExtensions -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlElementFactoryExtensions</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlAttribute</span> <span class="nf">CreateAttributeRaw</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">,</span> <span class="k">this</span> <span class="kt">string</span> <span class="n">attributeText</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlFile</span> <span class="nf">CreateFileRaw</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlElementFactory</span> <span class="n">factory</span><span class="p">,</span> <span class="k">this</span> <span class="kt">string</span> <span class="n">xmlText</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="ElementFactories.html#ixmlelementfactory"><span>IXmlElementFactory</span></a>, <a href="TreeNodes.html#ixmlfile"><span>IXmlFile</span></a></li>
</ul>

<!-- End XmlElementFactoryExtensions -->

<p>Creates an instance of <a href="TreeNodes.html#ixmlfile"><span><code class="code highlight language-text">IXmlFile</code></span></a> or <a href="TreeNodes.html#ixmlattribute"><span><code class="code highlight language-text">IXmlAttribute</code></span></a> using the passed in <code class="code highlight language-text">IXmlElementFactory</code> without putting the created file into a sandbox. The resulting node is essentially not fully initialised - it is not part of a file, and not part of a sandbox, either.</p>

<a name="xmlreferenceutil" class="elem-anchor"></a>
<h3>XmlReferenceUtil<a href="#xmlreferenceutil" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlReferenceUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlReferenceUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TReference</span> <span class="n">FindReferenceRecursively</span><span class="p">&lt;</span><span class="n">TReference</span><span class="p">&gt;(</span><span class="n">ITreeNode</span> <span class="n">element</span><span class="p">,</span> <span class="n">Predicate</span><span class="p">&lt;</span><span class="n">TReference</span><span class="p">&gt;</span> <span class="n">predicate</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<!-- End XmlReferenceUtil -->

<p>Helper method that will recursively walk down the PSI tree starting at <code class="code highlight language-text">element</code>, looking for a particular reference, as decided by <code class="code highlight language-text">predicate</code>.</p>

<a name="xmltagextensions" class="elem-anchor"></a>
<h3>XmlTagExtensions<a href="#xmltagextensions" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlTagExtensions -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlTagExtensions</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlAttribute</span> <span class="nf">GetAttribute</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">,</span> <span class="k">this</span> <span class="n">Predicate</span><span class="p">&lt;</span><span class="n">IXmlAttribute</span><span class="p">&gt;</span> <span class="n">predicate</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlAttribute</span> <span class="nf">GetAttribute</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">,</span> <span class="k">this</span> <span class="kt">string</span> <span class="n">fullName</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">TreeNodeEnumerable</span><span class="p">&lt;</span><span class="n">IXmlAttribute</span><span class="p">&gt;</span> <span class="n">GetAttributes</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetFullTagName</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlIdentifier</span> <span class="nf">GetName</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IXmlIdentifier</span> <span class="nf">GetNameNode</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTagName</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTagNamespace</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="k">this</span> <span class="n">IXmlTag</span> <span class="n">xmlTag</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmlattribute"><span>IXmlAttribute</span></a>, <a href="TreeNodes.html#ixmlidentifier"><span>IXmlIdentifier</span></a>, <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End XmlTagExtensions -->

<p>Convenience methods that call into properties and methods on <a href="TreeNodes.html#ixmltag"><span><code class="code highlight language-text">IXmlTag</code></span></a> and child nodes. E.g. <code class="code highlight language-text">GetTagName</code> returns <code class="code highlight language-text">tag.Header.Name.XmlName</code>, and <code class="code highlight language-text">Remove</code> finds the tag’s parent <a href="TreeNodes.html#ixmltagcontainer"><span><code class="code highlight language-text">IXmlTagContainer</code></span></a> and calls <code class="code highlight language-text">IXmlTagContainer.RemoveTag</code>.</p>

<a name="xmltagutil" class="elem-anchor"></a>
<h3>XmlTagUtil<a href="#xmltagutil" class="anchor-link"><span></span></a></h3>

<!-- Begin XmlTagUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XmlTagUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">CanBeEmptyTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MakeCompound</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
  <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MakeEmptyTag</span><span class="p">(</span><span class="n">IXmlTag</span> <span class="n">tag</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmltag"><span>IXmlTag</span></a></li>
</ul>

<!-- End XmlTagUtil -->

<p>Helper methods for working with <code class="code highlight language-text">IXmlTag</code>.</p>

<ul>
  <li><code class="code highlight language-text">CanBeEmptyTag</code> returns <code class="code highlight language-text">true</code> if the given tag doesn’t have any significant children (e.g. anything other than whitespace), and checks that the current XML language supports converting this tag to be empty, by calling <code class="code highlight language-text">IXmlLanguageSupport.CanMakeTagEmpty</code>.</li>
  <li><code class="code highlight language-text">MakeCompound</code> converts an empty, self-closed tag to an empty tag with a header and footer, (e.g. <code class="code highlight language-text">&lt;foo&gt;&lt;/foo&gt;</code>). Modifies the tree, taking the write lock.</li>
  <li><code class="code highlight language-text">MakeEmpty</code> removes all inner nodes and the footer, and converts the header into a self-closing tag (e.g. <code class="code highlight language-text">&lt;foo /&gt;</code>). Modifies the tree, taking the write lock.</li>
</ul>

<a name="xpathutil" class="elem-anchor"></a>
<h3>XPathUtil<a href="#xpathutil" class="anchor-link"><span></span></a></h3>

<!-- Begin XPathUtil -->

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">XPathUtil</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">static</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">GetNestedTags</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">IXmlTagContainer</span> <span class="n">container</span><span class="p">,</span> <span class="kt">string</span> <span class="n">xpath</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<ul>
  <li>See also: <a href="TreeNodes.html#ixmltagcontainer"><span>IXmlTagContainer</span></a></li>
</ul>

<!-- End XPathUtil -->

<p>Walks the child tags of the <code class="code highlight language-text">container</code> until it has satisfied the given XPath-like expression. The <code class="code highlight language-text">xpath</code> parameter isn’t really an XPath string, but XPath-like. The path must be relative to the current <code class="code highlight language-text">container</code>, and walks down the tree comparing the tag names at each level with the current path segment name. If the name matches, or the path segment is the wildcard symbol <code class="code highlight language-text">*</code>, the walk continues. The tags that match the last path segment name are returned as part of the list.</p>



                    <div class="last-modified">
                        Last modified: 8 May 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper/devguide/app/js/main.build" data-baseurl="/resharper/devguide/" src="/resharper/devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

