


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title> / ReSharper  DevGuide</title>
    <link rel="stylesheet" href="/resharper/devguide/app/css/styles.min.css">

    <!-- non-retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-72x72.png" sizes="72x72">

    <!-- retina iPhone pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-114x114.png" sizes="114x114">

    <!-- retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon" href="/resharper/devguide/apple-touch-icon-144x144.png" sizes="144x144">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/resharper/devguide/apple-touch-icon-precomposed.png">

    <!-- normal favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/resharper/devguide/favicon.ico">
    <link rel="icon" type="image/png" href="/resharper/devguide/favicon.png">
<link  rel="stylesheet" href="/resharper/devguide/styles/styles.css"></head>
<body data-id="Platform/Shell/Icons/CreatingCompiledIcons">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search ReSharper  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a href="https://youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2015 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>ReSharper DevGuide</h3>
                
        <div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select id="switch-shortcuts" class="select _shortcuts" height="1">
            <option data-group="primary" value="default" selected>Default</option>
            <option data-group="primary" value="default_for_gnome">GNOME</option>
            <option data-group="primary" value="default_for_kde">KDE</option>
            <option data-group="primary" value="default_for_xwin">XWindow</option>
            <option data-group="primary" value="emacs">Emacs</option>
            <option data-group="primary" value="jbuilder">JBuilder</option>
            <option data-group="primary" value="visual_studio">Visual Studio</option>
            <option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option>
            <option data-group="primary" value="eclipse">Eclipse</option>
            <option data-group="secondary" value="mac_os_x_10.5_">OS X 10.5+</option>
            <option data-group="secondary" value="mac_os_x">OS X</option>
            <option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option></select>
        </div>
    
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">

                    
                    <a name="creating-compiled-icons" class="elem-anchor"></a>
<h1>Creating Compiled Icons<a href="#creating-compiled-icons" class="anchor-link"><span></span></a></h1>

<p>The most common type of icon is the compiled icon, represented by <code class="code highlight language-text">CompiledIconId</code>. These icons are embedded into assembly references at compile type, as XAML resources.</p>

<p>The ReSharper SDK includes MSBuild build actions and a custom task that will generate icons from either XAML or PNG files. The custom task generates two files - a new XAML file containing a <code class="code highlight language-text">DrawingBrush</code> resource for each image, and a C# file providing the <code class="code highlight language-text">CompiledIconId</code> instances, and pointers to the new XAML resource dictionary. Once the files have been generated, they should both be added to the Visual Studio project.</p>

<a name="themed-icons" class="elem-anchor"></a>
<h2>Themed icons<a href="#themed-icons" class="anchor-link"><span></span></a></h2>

<p>Themed icons are supported by including multiple images in the generated XAML file, one version for each theme aspect supported. Each image is annotated with its own name and the theme aspect that it is intended for, so themed icons will have multiple images with the same name, but different theme aspect names.</p>

<p>When retrieving an icon, the aspects from the current theme are enumerated in priority order, and the first matching image for the icon is used. If there are no images that match any of the theme aspects, the fallback image is used, if available. A fallback image is an image that is created without a theme aspect. If there are no fallback images, an arbitrary themed image for the icon is used.</p>

<p>See the <a href="/resharper/devguide/Platform/Shell/Theming/Icons.html"><span>theming section</span></a> for more details about theming and theme aspects.</p>

<a name="xaml-icons" class="elem-anchor"></a>
<h2>XAML icons<a href="#xaml-icons" class="anchor-link"><span></span></a></h2>

<p>XAML images are the preferred format for icons, as they scale better for larger sizes and higher screen DPI resolutions.</p>

<p>The input XAML file should be a <code class="code highlight language-text">ResourceDictionary</code> containing a number of <code class="code highlight language-text">DrawingBrush</code> resources, all marked with an <code class="code highlight language-text">x:Key</code> attribute that uniquely identifies the icon by name. The file should be added to the Visual Studio project and have its build action set to <code class="code highlight language-text">ThemedIconsXamlV3</code>.</p>

<p>Each brush can contain multiple individual images, one for each supported theme aspect. The images are placed horizontally, and, rather than conforming to a strict grid, the custom task will automatically discover distinct, non-overlapping images. These images are saved to the new, generated XAML file, again as a <code class="code highlight language-text">ResourceDictionary</code>, with each theme image being saved as its own individual <code class="code highlight language-text">DrawingBrush</code>.</p>

<p>The new XAML images need to be annotated, with both the name of the icon and the name of the theme aspect it is intended for. The theme aspect is retrieved from MSBuild metadata attached to the original XAML file. The <code class="code highlight language-text">ThemeColumns</code> element is used to provide a semi-colon separated list of theme aspect names, one for each image in the horizontal strip, in the same order.</p>

<p>Similar metadata is required to specify how the background of an individual image is processed. The <code class="code highlight language-text">RemoveBackgroundElement</code> describes this behaviour. To all intents and purposes, there is no need to configure this, other than to set the value to <code class="code highlight language-text">True</code>.</p>

<p>Both pieces of metadata are required, or the custom task will not process the XAML file. To add the metadata, edit the <code class="code highlight language-text">.csproj</code> project file, find the element that represents the original XAML file and set it as follows:</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_xml"><span class="nt">&lt;ThemedIconsXamlV3</span> <span class="na">Include=</span><span class="s">&quot;path-to-xaml-file&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ThemeColumns&gt;</span>Gray;GrayDark;Color<span class="nt">&lt;/ThemeColumns&gt;</span>
  <span class="nt">&lt;RemoveBackgroundElement&gt;</span>True<span class="nt">&lt;/RemoveBackgroundElement&gt;</span>
<span class="nt">&lt;/ThemedIconsXamlV3&gt;</span></code></pre>

<p>The names of the theme aspects are listed in the <a href="/resharper/devguide/Platform/Shell/Theming/Icons.html"><span>theming section</span></a>.</p>

<a name="png-icons" class="elem-anchor"></a>
<h2>PNG icons<a href="#png-icons" class="anchor-link"><span></span></a></h2>

<p>ReSharper also supports using PNG files as icons, although it is recommended to use XAML instead, as XAML files can scale better to larger sizes and higher screen DPI resolutions.</p>

<p>In order to create an icon from a PNG file, add the file to the Visual Studio project, and set its build action to <code class="code highlight language-text">ThemedIconPng</code>. The PNG file will typically be square, e.g. 16×16, although there are no restrictions to enforce this - a larger icon could be included for high DPI or simply for displaying at a larger size.</p>

<p>Theming is supported by a naming convention. The theme aspect name should be placed in square brackets, e.g. <code class="code highlight language-text">Foo[GrayDark].png</code>, and a separate PNG file used for each theme aspect. If a theme aspect name isn’t specified, the image is treated as a fallback image when failing to find a theme specific image.</p>

<p>The theme aspect names are listed in the <a href="/resharper/devguide/Platform/Shell/Theming/Icons.html"><span>theming section</span></a>.</p>

<a name="generated-files" class="elem-anchor"></a>
<h2>Generated files<a href="#generated-files" class="anchor-link"><span></span></a></h2>

<p>The custom task generates two files - a new XAML file containing the processed images, and a C# file that contains the <code class="code highlight language-text">CompiledIconId</code> instances.</p>

<p>The filenames are based on the name of the containing folder, using the format <code class="code highlight language-text">ThemedIcons.&lt;DIR&gt;.generated.cs</code> and <code class="code highlight language-text">ThemedIcons.&lt;DIR&gt;.generated.xaml</code>, where <code class="code highlight language-text">&lt;DIR&gt;</code> is the name of the containing folder, minus any <code class="code highlight language-text">Icons</code> suffix. E.g. the folder <code class="code highlight language-text">BarIcons</code> would create files called <code class="code highlight language-text">ThemedIcons.Bar.generated.cs</code> and <code class="code highlight language-text">ThemedIcons.Bar.generated.xaml</code>.</p>

<p>The generated XAML is a <code class="code highlight language-text">ResourceDictionary</code> where each themed image is created as an individual <code class="code highlight language-text">DrawingBrush</code>, annotated with the name of the icon and the theme aspect it is intended for.</p>

<p>The generated C# file contains <code class="code highlight language-text">CompiledIconId</code> instances used to identify and consume the icons. The generated classes are created inside a sealed class to prevent any clashes with other classes inside that namespace. Each class derives from the empty, abstract <code class="code highlight language-text">CompiledIconClass</code> class and are marked with the <code class="code highlight language-text">[CompiledIconClass]</code> attribute, to allow for discovery of icon XAML files at runtime. The class also declares a couple of assembly level attributes, to help with identifying and loading the icon XAML files, assigning the friendly name to the image in the XAML, and to register a XAML namespace for the icons.</p>

<p>Each class has a single public static field called <code class="code highlight language-text">Id</code>, which is the instance of <code class="code highlight language-text">IconId</code> that you use when consuming the icon.</p>

<pre><code class="code-block__wrapper code-block _highlighted lang_csharp"><span class="k">namespace</span> <span class="nn">Foo</span>
<span class="p">{</span>
  <span class="c1">// Name based on the folder containing the images - Bar</span>
  <span class="k">public</span> <span class="k">sealed</span> <span class="k">class</span> <span class="nc">BarThemedIcons</span>
  <span class="p">{</span>
    <span class="c1">// The attribute allows for discovery of the XAML. The first argument</span>
    <span class="c1">// is the XAML pack address of the embedded XAML resource. The second</span>
    <span class="c1">// argument is the icon index, and the third is the name</span>
<span class="na">    [CompiledIconClass(&quot;.../ThemedIcons.Bar.generated.xaml&quot;, 0, &quot;Quux&quot;)]</span>
    <span class="k">public</span> <span class="k">sealed</span> <span class="k">class</span> <span class="nc">Quux</span> <span class="p">:</span> <span class="n">CompiledIconClass</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">static</span> <span class="n">IconId</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CompiledIconId</span><span class="p">(</span><span class="s">&quot;.../ThemedIcons.Bar.generated.xaml&quot;</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="s">&quot;Quux&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<p>Once the files have been generated for the first time, they should be added to the Visual Studio project.</p>

<a name="other-useful-metadata" class="elem-anchor"></a>
<h2>Other useful metadata<a href="#other-useful-metadata" class="anchor-link"><span></span></a></h2>

<p>The custom task also recognises the <code class="code highlight language-text">FullPath</code> metadata, which is useful if the icons are being linked into the Visual Studio project from another location, perhaps shared between projects. The <code class="code highlight language-text">FullPath</code> metadata should be the expected full path to the output location, where the generated files will be placed.</p>



                    <div class="last-modified">
                        Last modified: 3 August 2015
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>


<script data-main="/resharper/devguide/app/js/main.build" data-baseurl="/resharper/devguide/" src="/resharper/devguide/app/js/vendor/requirejs/require.js"></script>

</body>
</html>

